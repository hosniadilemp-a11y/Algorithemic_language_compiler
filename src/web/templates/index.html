<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlgoCompiler - L'Algorithmique Moderne</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v=3">
    <!-- CodeMirror Core -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/dracula.min.css">

    <!-- CodeMirror Addons - CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/show-hint.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldgutter.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/dialog/dialog.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/scroll/simplescrollbars.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='intellisense-icons.css') }}?v=9">
    <link rel="stylesheet" href="{{ url_for('static', filename='editor-enhancements.css') }}?v=9">

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- CodeMirror Core JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/pascal/pascal.min.js"></script>

    <!-- CodeMirror Addons - JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/show-hint.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/closebrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/comment/comment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/selection/active-line.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldgutter.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/indent-fold.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/brace-fold.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/search.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/searchcursor.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/jump-to-line.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/dialog/dialog.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/scroll/annotatescrollbar.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/scroll/simplescrollbars.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/selection/mark-selection.min.js"></script>
</head>

<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-terminal"></i> AlgoCompiler
            </div>
            <div class="controls">
                <input type="text" id="filename-input" class="filename-input" value="programme.algo" spellcheck="false">
                <button id="new-btn" class="btn secondary" title="Nouveau fichier (Ctrl+N)">
                    <i class="fas fa-file"></i>
                </button>
                <button id="open-btn" class="btn secondary" title="Ouvrir un fichier .algo">
                    <i class="fas fa-folder-open"></i>
                </button>
                <input type="file" id="file-input" accept=".algo" style="display: none;">
                <button id="save-btn" class="btn secondary" title="Sauvegarder (Ctrl+S)">
                    <i class="fas fa-save"></i>
                </button>
                <div class="separator"></div>
                <!-- Sliding Examples Panel Button -->
                <button id="open-examples-btn" class="btn secondary" title="Ouvrir la bibliothèque d'exemples">
                    <i class="fas fa-book"></i> Exemples
                </button>
                <div class="separator"></div>
                <a href="/course" class="btn secondary highlight" title="Ouvrir le cours d'algorithmique">
                    <i class="fas fa-graduation-cap"></i> Cours
                </a>
                <div class="separator"></div>
                <button id="input-file-btn" class="btn secondary" title="Charger un fichier d'entrée (stdin)">
                    <i class="fas fa-file-import"></i> Entrée
                </button>
                <input type="file" id="input-file-select" style="display: none;">
                <span id="input-file-status" style="font-size: 0.8em; color: #8b949e; display: none;">Fichier
                    chargé</span>
                <button id="run-btn" class="btn primary">
                    <i class="fas fa-play"></i> Exécuter
                </button>
            </div>
        </header>

        <main class="editor-layout">
            <div class="pane editor-pane">
                <div class="pane-header">
                    <span><i class="fas fa-code"></i> Algorithme</span>
                    <div style="display:flex;gap:6px;align-items:center">
                        <span id="file-state" class="badge" style="display: none;">Modifié</span>
                        <span class="lang-badge">ALGO</span>
                        <button id="fullscreen-btn" class="toolbar-btn" title="Plein Écran (F11)"><i
                                class="fas fa-expand"></i></button>
                        <button id="shortcuts-btn" class="toolbar-btn" title="Raccourcis clavier"><i
                                class="fas fa-keyboard"></i></button>
                    </div>
                </div>
                <!-- Editor Toolbar -->
                <div class="editor-toolbar">
                    <button id="undo-btn" class="toolbar-btn" title="Annuler (Ctrl+Z)">
                        <i class="fas fa-undo"></i>
                    </button>
                    <button id="redo-btn" class="toolbar-btn" title="Refaire (Ctrl+Y)">
                        <i class="fas fa-redo"></i>
                    </button>
                    <div class="toolbar-separator"></div>
                    <button id="comment-btn" class="toolbar-btn" title="Commenter/Décommenter (Ctrl+/)">
                        <i class="fas fa-comment-slash"></i>
                    </button>
                    <div class="toolbar-separator"></div>
                    <button id="search-btn" class="toolbar-btn" title="Rechercher (Ctrl+F)">
                        <i class="fas fa-search"></i>
                    </button>
                    <button id="replace-btn" class="toolbar-btn" title="Remplacer (Ctrl+H)">
                        <i class="fas fa-exchange-alt"></i>
                    </button>
                    <div class="toolbar-separator"></div>
                    <button id="format-btn" class="toolbar-btn" title="Formater le code">
                        <i class="fas fa-align-left"></i>
                    </button>
                </div>
                <!-- Editor placeholder -->
                <textarea id="code-editor" spellcheck="false">Algorithme ExempleComplet;
Var
    nom : Chaine;
    age : Entier;
    i : Entier;
Debut
    Ecrire("=== Programme de Démonstration ===");
    
    // Lecture des données
    Ecrire("Entrez votre nom:");
    Lire(nom);
    Ecrire("Entrez votre age:");
    Lire(age);
    
    // Condition
    Si age >= 18 Alors
        Ecrire("Bonjour ", nom, ", vous etes majeur!");
    Sinon
        Ecrire("Bonjour ", nom, ", vous etes mineur.");
    Fin Si;
    
    // Boucle
    Ecrire("Comptage de 1 a 5:");
    Pour i de 1 a 5 Faire
        Ecrire("Nombre: ", i);
    Fin Pour;
    
    Ecrire("Programme termine!");
Fin.</textarea>

                <!-- Status Bar -->
                <div id="editor-status-bar" class="editor-status-bar">
                    <div class="status-left">
                        <span id="status-cursor" class="status-item" title="Ligne et Colonne"><i
                                class="fas fa-map-pin"></i> Ln 1, Col 1</span>
                        <span class="status-sep">|</span>
                        <span id="status-chars" class="status-item" title="Caractères totaux"><i
                                class="fas fa-font"></i> 0 car.</span>
                        <span class="status-sep">|</span>
                        <span id="status-lines" class="status-item" title="Lignes totales"><i
                                class="fas fa-list-ol"></i> 0 lignes</span>
                    </div>
                    <div class="status-right">
                        <button id="wordwrap-btn" class="status-btn" title="Activer/Désactiver le retour à la ligne"><i
                                class="fas fa-text-width"></i> Wrap</button>
                        <span class="status-sep">|</span>
                        <button id="font-decrease-btn" class="status-btn" title="Réduire la taille du texte (Ctrl+-)"><i
                                class="fas fa-minus"></i></button>
                        <span id="status-fontsize" class="status-item">14px</span>
                        <button id="font-increase-btn" class="status-btn"
                            title="Augmenter la taille du texte (Ctrl+=)"><i class="fas fa-plus"></i></button>
                        <button id="font-reset-btn" class="status-btn" title="Réinitialiser la taille"><i
                                class="fas fa-redo-alt"></i></button>
                    </div>
                </div>
            </div>

            <!-- Resizable Drag Splitter -->
            <div id="pane-splitter" class="pane-splitter" title="Redimensionner"></div>

            <div class="pane output-pane">
                <!-- Console Section -->
                <div class="pane-header">
                    <span><i class="fas fa-desktop"></i> Sortie (Console)</span>
                    <div style="display: flex; gap: 5px; align-items: center;">
                        <button id="clear-console-btn" class="icon-btn" title="Effacer la console">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                        <span id="status-badge" class="badge">Prêt</span>
                    </div>
                </div>
                <div id="execution-output" class="console">
                    <div id="console-logs"></div>
                    <div id="console-input-container" style="display: none;">
                        <span class="prompt">&gt;</span>
                        <input type="text" id="console-input" autocomplete="off">
                    </div>
                </div>

                <!-- Variable Inspector Section -->
                <div class="pane-header">
                    <span><i class="fas fa-search"></i> Inspecteur de Variables (Trace)</span>
                </div>
                <div id="variables-pane" class="console variables-container">
                    <table id="variables-table">
                        <thead>
                            <tr>
                                <th>Variable</th>
                                <th>Valeur</th>
                                <th>Adresse</th>
                            </tr>
                        </thead>
                        <tbody id="variables-body">
                            <!-- Variables will appear here -->
                            <tr>
                                <td colspan="2" class="placeholder-text">Aucune donnée</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Transpiled Output Removed -->
            </div>
        </main>
    </div>

    <!-- Keyboard Shortcuts Modal -->
    <div id="shortcuts-modal" class="shortcuts-modal" style="display:none;">
        <div class="shortcuts-modal-content">
            <div class="shortcuts-modal-header">
                <h3><i class="fas fa-keyboard"></i> Raccourcis Clavier</h3>
                <button id="close-shortcuts-btn" class="icon-btn"><i class="fas fa-times"></i></button>
            </div>
            <div class="shortcuts-grid">
                <div class="shortcuts-col">
                    <div class="shortcuts-section-title">Fichier</div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>S</kbd><span>Sauvegarder</span></div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>O</kbd><span>Ouvrir</span></div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>N</kbd><span>Nouveau</span></div>
                    <div class="shortcuts-section-title">Édition</div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>Z</kbd><span>Annuler</span></div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>Y</kbd><span>Rétablir</span></div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>/</kbd><span>Commenter/Décommenter</span></div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>D</kbd><span>Dupliquer la
                            ligne</span></div>
                    <div class="shortcut-row"><kbd>Alt</kbd>+<kbd>↑/↓</kbd><span>Déplacer la ligne</span></div>
                </div>
                <div class="shortcuts-col">
                    <div class="shortcuts-section-title">Navigation</div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>F</kbd><span>Rechercher</span></div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>H</kbd><span>Remplacer</span></div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>G</kbd><span>Aller à la ligne</span></div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>D</kbd><span>Sélection multiple</span></div>
                    <div class="shortcuts-section-title">Affichage</div>
                    <div class="shortcut-row"><kbd>F11</kbd><span>Plein écran</span></div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>=</kbd><span>Zoom avant</span></div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>-</kbd><span>Zoom arrière</span></div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>Space</kbd><span>Autocomplétion</span></div>
                    <div class="shortcut-row"><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>F</kbd><span>Formater le code</span>
                    </div>
                    <div class="shortcut-row"><kbd>F5</kbd><span>Exécuter</span></div>
                </div>
            </div>
        </div>
    </div>
    <div id="shortcuts-overlay" class="shortcuts-overlay" style="display:none;"></div>

    <!-- Off-Canvas Examples Sidebar (Barre Coulissante) -->
    <div id="examples-sidebar" class="examples-sidebar">
        <div class="examples-header">
            <h3><i class="fas fa-book"></i> Bibliothèque d'Exemples</h3>
            <button id="close-examples-btn" class="icon-btn" title="Fermer">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div id="examples-content" class="examples-content">
            <!-- Example categories and buttons will be injected here by Javascript -->
            <div class="placeholder-text text-center mt-5">
                <i class="fas fa-spinner fa-spin fa-2x"></i><br><br>Chargement des exemples...
            </div>
        </div>
    </div>
    <div id="examples-overlay" class="examples-overlay"></div>

    <script src="{{ url_for('static', filename='algo-mode.js') }}?v=10"></script>
    <script src="{{ url_for('static', filename='algo-hints.js') }}?v=10"></script>
    <script src="{{ url_for('static', filename='algo-fold.js') }}?v=10"></script>
    <script src="{{ url_for('static', filename='script.js') }}?v=11"></script>
</body>

</html>
